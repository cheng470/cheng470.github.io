<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>使用 Hugo 搭建博客 | cheng470 的博客</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="记录 Hugo 的使用"><meta name=generator content="Hugo 0.102.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="使用 Hugo 搭建博客"><meta property="og:description" content="记录 Hugo 的使用"><meta property="og:type" content="article"><meta property="og:url" content="https://cheng470.github.io/posts/%E4%BD%BF%E7%94%A8-hugo-%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-29T00:21:41+08:00"><meta property="article:modified_time" content="2022-08-29T00:21:41+08:00"><meta itemprop=name content="使用 Hugo 搭建博客"><meta itemprop=description content="记录 Hugo 的使用"><meta itemprop=datePublished content="2022-08-29T00:21:41+08:00"><meta itemprop=dateModified content="2022-08-29T00:21:41+08:00"><meta itemprop=wordCount content="510"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 Hugo 搭建博客"><meta name=twitter:description content="记录 Hugo 的使用"></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">cheng470 的博客</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">使用 Hugo 搭建博客</h1><time class="f6 mv4 dib tracked" datetime=2022-08-29T00:21:41+08:00>August 29, 2022</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p><code>Hugo</code> 是由 Go 语言实现的静态网站生成器。这篇文章记录在本地 Arch Linux 上，安装搭建 hugo 的过程，并部署到 github 。</p><h2 id=安装>安装</h2><p>推荐用各自系统的包管理器进行安装。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pacman -S hugo
</span></span></code></pre></div><h2 id=本地创建网站>本地创建网站</h2><p>下面创建一个 <code>cheng470.github.io</code> 的网站，然后添加 ananke 主题：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hugo new site cheng470.github.io
</span></span><span style=display:flex><span>cd cheng470.github.io
</span></span><span style=display:flex><span>git init
</span></span><span style=display:flex><span>git submodule add https://github.com/theNewDynamic/gohugo-theme-ananke.git themes/ananke
</span></span><span style=display:flex><span>echo theme <span style=color:#f92672>=</span> <span style=color:#ae81ff>\&#34;</span>ananke<span style=color:#ae81ff>\&#34;</span> &gt;&gt; config.toml
</span></span></code></pre></div><h3 id=添加文章>添加文章</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hugo new posts/my-first-post.md
</span></span></code></pre></div><h3 id=启动服务>启动服务</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hugo server -D
</span></span></code></pre></div><h3 id=生成静态页面>生成静态页面</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hugo -D
</span></span></code></pre></div><h2 id=部署到-github>部署到 Github</h2><p>新建 github 工程 <code>cheng470.github.io</code> , 开启 <code>Pages</code> 功能，设置分支为 <code>gh-pages</code>。</p><p>执行如下命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git remote add origin git@github.com:cheng470/cheng470.github.io.git
</span></span><span style=display:flex><span>git pull
</span></span></code></pre></div><p>之后把所有代码提交上去，现在还不能访问，还需要配置 <code>GitHub Action</code>，让它帮忙自动运行 hugo 的工具来生成静态页面到 <code>gh-pages</code> 分支。</p><h3 id=配置-github-action>配置 GitHub Action</h3><p>创建文件 <code>.github/workflows/gh-pages.yml</code> 内容如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>github pages</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>main </span> <span style=color:#75715e># Set a branch to deploy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-20.04</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>  <span style=color:#75715e># Fetch Hugo themes (true OR recursive)</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>    <span style=color:#75715e># Fetch all history for .GitInfo and .Lastmod</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setup Hugo</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#39;latest&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># extended: true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-gh-pages@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>if</span>: <span style=color:#ae81ff>github.ref == &#39;refs/heads/main&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>github_token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>publish_dir</span>: <span style=color:#ae81ff>./public</span>
</span></span></code></pre></div><p>提交到仓库中。</p><p>这样就可以成功访问了。</p><h2 id=问题>问题</h2><h3 id=首页的摘要格式很乱>首页的摘要格式很乱</h3><p>比如：</p><p><img src=/%E4%BD%BF%E7%94%A8-hugo-%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/%E6%91%98%E8%A6%811%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F.png alt=摘要格式很乱></p><p>这是因为 hugo 默认取文章的前70个单词作为摘要，内部算法是通过空格对文章内容做 split 后取前面的 70 个单词。</p><p>这里是汉字，没有空格，所以看起来很长。可以在 hugo 的配置里面加上 <code>hasCJKLanguage = true</code> 配置来修正：</p><p><img src=/%E4%BD%BF%E7%94%A8-hugo-%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/%E6%91%98%E8%A6%812%E4%BD%BF%E7%94%A8cjk%E5%BC%80%E5%85%B3%E5%90%8E%E7%9A%84%E6%95%88%E6%9E%9C.png alt=使用cjk开关后的摘要></p><p>但也不好看，hugo 还支持手动生成摘要的方式，在摘要和文章主体内容之间加入摘要分割符 &lt;!--more--> 来生成摘要。效果如下：</p><p><img src=/%E4%BD%BF%E7%94%A8-hugo-%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/%E6%91%98%E8%A6%813%E4%BD%BF%E7%94%A8%E6%91%98%E8%A6%81%E5%88%86%E5%89%B2%E7%AC%A6%E5%90%8E%E7%9A%84%E6%95%88%E6%9E%9C.png alt=使用摘要分隔符后的摘要></p><h2 id=参考>参考</h2><ul><li><a href=https://gohugo.io/getting-started/quick-start/>Quick Start | Hugo</a></li><li><a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/>Host on GitHub | Hugo</a></li></ul><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://cheng470.github.io/>&copy; cheng470 的博客 2022</a><div><div class=ananke-socials></div></div></div></footer></body></html>